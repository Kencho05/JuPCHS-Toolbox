# Analyzing Port-Controlled Hamiltonian Systems

## Finding a minimum of the Hamiltonian

The minumum point of the Hamiltonian is relevant in several analysis, including stability and passivity analysis.  JuPCHS has a function to solve numerically this problem by using the conjugate gradient method.  The sintaxis is the following

    xop, hm = Hmin(PCHS=PCHS1, xini=x0)

where, **PCHS1** is a PCHS and **xini** is an initial condition. The function outputs the minimum $H$ value, the corresponding state variable, and a convergence plot for the optimization problem. The function can be also called without initial condition:

    hm = Hmin(PCHS=PCHS1)

In that case, we assume xini set to 0.

## Checking an admissible equilibrium

You can verify whether a desired point is numerically classified as an admissible equilibrium. The function returns a binary value (true/false) according to the verification. The sintaxis is the following 

    r = AdmissibleEquilibrium(PCHS=PCHS1)

If no desired point is provided, the default value is zero.

## Finding an equilibrium point

Likewise, the equilibrium point of the system can be computed under three possible situations: when a desired input $u_{desired}$ is provided, when desired state variables $x_{desired}$ are given, or when no desired values are specified. The function evaluates the equilibrium using both a fixed-point method and a Newton method. In the Newton approach, the Karush--Kuhn--Tucker (KKT) conditions are applied to obtain the optimal solution. The sintaxis is the following 

    xop, uop = equilibrium_point(PCHS=PCHS1, ud=udesired)

This case corresponds to the scenario where a desired input is provided. The optimization process computes the optimal state $x_{op}$ and, if necessary, adjusts the admissible desired input so that it is consistent with the system.

## Checking Lipschitz Continuity

In Hamiltonian-based systems, knowing whether the Hamiltonian function is Lipschitz continuous can helps guarantee well-posedness, numerical stability, and the control design. To support this verification, the package provides a numerical routine that checks the Lipschitz continuity of the Hamiltonian and, when applicable, returns the corresponding Lipschitz constant. The sintaxis is the following 

    L = islipschitz(f=PCHS1.H,nx=2)

where the parameter **f** expects the Hamiltonian function, and **nx** indicates the number of state variables.


## Content

* [Defining PCHS](CH01.md)
* [Interconnecting PHCS](CH02.md)
* [Simulating PCHS](CH03.md)
* [Analyzing PCHS](CH04.md)
* [Examples](CH05.md)
* [List of functions](CH06.md)

---
Back: [Simulating PCHS](CH03.md)
Next: [Examples](CH05.md)

---
Readme: [Proyect root](https://github.com/Kencho05/JuPCHS-Toolbox)